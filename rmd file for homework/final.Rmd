---
title: "Result"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
general_data <- read.csv(file = '../assignmentand data/Data_Livestream_General_processed.csv')
```

```{r}
#general_data
```
```{r}
#change date
general_data$Date <- as.Date(general_data$Start_time,format='%m/%d/%y')
#group revenue by day, host

general_data_aggbydate <-  ddply(general_data, .(Name, Date, Host_category), summarize,  dayrevenue=sum(Total_sales_amount))
#general_data_aggbydate

```
```{r}
video_data <- read_excel("../assignmentand data/Data_Short_Videos.xlsx")

#video_data
```
```{r}
average_data_per_hosts <- ddply(video_data, .(Name), summarize,  like=mean(Number_of_likes, na.rm = TRUE), comments=mean(Number_of_comments, na.rm = TRUE), repost = mean(Number_of_reposts))
#average_data_per_hosts
```
```{r}
library(tidyr)
library(plyr)

general_data_average_re <-  ddply(general_data_aggbydate, .(Name,  Host_category), summarize,  dailyrevenue=mean(dayrevenue, na.rm = TRUE))
#general_data_average_re
```
```{r}
mergedData <- merge(general_data_average_re, average_data_per_hosts, by.x=c('Name'), by.y=c('Name'))
#mergedData
```
```{r}
library(ggplot2)
library(ggrepel)
library(ggpubr)

#my.formula <- y ~ x
ggplot(data = mergedData, aes(x =like, y =  dailyrevenue, color = Host_category,label = Name)) +
  geom_point()+
  #geom_text(aes(label=Ho),size = 2.5, hjust=1, vjust=0.5) + 
  geom_text_repel(size = 2.5, nudge_y = 10, show.legend = FALSE) +
  ggtitle("like versus revenue")+
  geom_smooth(method = "lm", se=FALSE, formula = 'y ~ x')+
facet_grid(~ Host_category)


ggplot(data = mergedData, aes(x =comments, y =  dailyrevenue, color = Host_category,label = Name)) +
  geom_point()+
  #geom_text(aes(label=Ho),hjust=1, vjust=0) + 
  geom_text_repel(size = 2.5, nudge_y = 10, show.legend = FALSE) +
  ggtitle("comments versus revenue")+
  geom_smooth(method="lm", se= FALSE, formula = 'y ~ x')+
facet_grid(~ Host_category)

ggplot(data = mergedData, aes(x =repost, y =  dailyrevenue, color = Host_category,label = Name)) +
  geom_point()+
  #geom_text(aes(label=Ho),hjust=1, vjust=0) + 
  geom_text_repel(size = 2.5, nudge_y = 10, show.legend = FALSE, max.overlaps = Inf) +
  ggtitle("repost versus revenue")+
  geom_smooth(method="lm", se= FALSE, formula = 'y ~ x')+
facet_grid(~ Host_category)
```
If we have a look at the relationship between the number of like, comments, and repost of the videos posted by each host and the daily revenues of live streams conducted by different hosts, we find that there’s a positive correlation of average revenue to the average likes and comments received by each host’s video. However, this relationship exist only for the celebrities. For the KOL, there’s almost no correlation between their average daily revenue to the average likes and comments for their video. One thing that we also notice is that the average number of repost received by the videos is also uncorrelated to the number of revenue generated by each hosts, no matter these hosts are celebrities or KOL. This could be partly explained by the following image, where we created a scatter plot for the number of like, comments and reposts received by all of the video in our data. 

```{r}
pairs(video_data[,6:8])

```
While the number of likes is highly correlated by the number of comments. The number of reposts appear to be not correlated with either comments or likes. Thus, we conclude while people exhibit the same pattern for liking or commenting a douyin video, they exhibit a different pattern for reposting a video, and this different pattern is less related to whether people would actually shop when the poster of these video conduct a live stream. 

To further investigate why the number of likes and comments are correlated to the daily revenue for celebrities. We explored the relationship of average number of likes and comments versus some other statistic of each session of live streams, including the number of viewers, the number of gifts received, the number of new fans, etc. Here we found that the average number of likes and comments of a host is also correlated to the number of viewers entering a live stream conducted by this host. Compared to the daily revenue, the average number of viewer is more strongly correlated to the number of likes and comments. We also notice that this relationship is much stronger for celebrities compared to KOL.

```{r}
general_data_nonull <- na.omit(general_data) 

more_average_data_per_hosts <- ddply(general_data_nonull, .(Name, Host_category), summarize,  peak=mean(Peak_viewers, na.rm = TRUE), gifts=mean(Gifts_from_viewers, na.rm = TRUE), revenue = mean(Total_sales_amount), viewer=mean(Views), average_viewers=mean(Average_number_of_online_viewers, na.rm = TRUE), likes_stream=mean(Number_of_likes, na.rm = TRUE), nf_stream=mean(Number_of_new_followers, na.rm = TRUE))
#more_average_data_per_hosts
```
```{r}
more_mergedData <- merge(more_average_data_per_hosts, average_data_per_hosts, by.x=c('Name'), by.y=c('Name'))
#more_mergedData
```
```{r}
pairs(more_mergedData[,3:12])

```
```{r}
ggplot(data = more_mergedData, aes(x =like, y =  viewer, color = Host_category,label = Name)) +
  geom_point()+
  #geom_text(aes(label=Ho),hjust=1, vjust=0) + 
  geom_text_repel(size = 2.5, nudge_y = 10, show.legend = FALSE, max.overlaps = Inf) +
  ggtitle("viewer versus like")+
  geom_smooth(method="lm", se= FALSE, formula = 'y ~ x')

ggplot(data = more_mergedData, aes(x =comments, y =  viewer, color = Host_category,label = Name)) +
  geom_point()+
  #geom_text(aes(label=Ho),hjust=1, vjust=0) + 
  geom_text_repel(size = 2.5, nudge_y = 10, show.legend = FALSE, max.overlaps = Inf) +
  ggtitle("viewer versus comments")+
  geom_smooth(method="lm", se= FALSE, formula = 'y ~ x')

ggplot(data = more_mergedData, aes(x =repost, y =  viewer, color = Host_category,label = Name)) +
  geom_point()+
  #geom_text(aes(label=Ho),hjust=1, vjust=0) + 
  geom_text_repel(size = 2.5, nudge_y = 10, show.legend = FALSE, max.overlaps = Inf) +
  ggtitle("viewer versus repost")+
  geom_smooth(method="lm", se= FALSE, formula = 'y ~ x')
```
Thus, we conclude that whether they are a lot of people likes or comments on a hosts’ videos may direct influence the number of viewers of each live stream of the hosts, because people who like or comment on a host’s video would probably lead to people’s further action of going into the host’s live stream room and check out what the host is selling. However, for celebrities, this action of going into hosts’ room would more likely result in people actually buying stuff, while this is not the same for KOLs.


```{r}
ggplot(data = general_data, aes(x =Views, y =  Total_sales_amount, color = Host_category,label = Name)) +
  geom_point()+
  #geom_text(aes(label=Ho),hjust=1, vjust=0) + 
  #geom_text_repel(size = 2.5, nudge_y = 10, show.legend = FALSE, max.overlaps = Inf) +
  ggtitle("viewer versus re")+
  geom_smooth(method="lm", se= FALSE)+
  facet_wrap(~Host_category)
```


